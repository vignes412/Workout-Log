# Progressive Web App Features

This document provides information on how to use and test the Progressive Web App (PWA) features of Workout Log.

## Installation

The Workout Log app can be installed on various devices for an app-like experience:

### Desktop
1. Open Chrome, Edge, or other compatible browsers
2. Visit the app URL
3. Look for the install icon in the address bar or a prompt to install
4. Click "Install" to add the app to your desktop

### Android
1. Open Chrome or compatible browser
2. Visit the app URL
3. When prompted, tap "Add to Home Screen"
4. The app will appear on your home screen

### iOS
1. Open Safari (required for iOS PWA installation)
2. Visit the app URL
3. Tap the Share button
4. Scroll down and tap "Add to Home Screen"
5. Tap "Add" in the dialog

## Offline Capabilities

The app includes several offline features:

- **Cache-first resources**: UI elements, images, and static content will load even when offline
- **Offline data access**: Previously loaded workouts will be available offline
- **Data synchronization**: Changes made offline will sync when connection returns
- **Offline mode indicator**: A banner will appear when the app is offline

## Testing Offline Mode

To test offline capabilities:
1. Open the app and allow it to fully load
2. Put your device in airplane mode or disable network connection
3. Try navigating between screens and viewing your workouts
4. Make changes to your data while offline
5. Restore network connection to see changes sync

## Background Synchronization

When you make changes while offline:
1. Changes are stored in the local IndexedDB database
2. A sync queue is created for changes that need to be sent to the server
3. When connection is restored, the app automatically processes the queue
4. The UI will indicate when syncing is complete

## Updates

The app will automatically check for updates:
1. When updates are available, a notification will appear
2. You can choose to update immediately or later
3. Updates install in the background for a seamless experience
4. The app will reload once updates are installed

## Troubleshooting

If you experience issues with the PWA:
- Clear your browser cache and data
- Ensure your browser is up-to-date
- Check that you have sufficient storage space
- Try uninstalling and reinstalling the app
- Verify your internet connection when syncing data

### Development Mode Issues

#### Service Worker Registration Error (HTTP 500)

If you encounter this error during development:

```
Service worker registration error: TypeError: Failed to register a ServiceWorker for scope ('http://localhost:3000/') with script ('http://localhost:3000/dev-sw.js?dev-sw'): A bad HTTP response code (500) was received when fetching the script.
```

This is usually caused by:
1. The development service worker script not being properly loaded
2. A misconfiguration in the Vite PWA plugin setup
3. Conflicts with previous service worker registrations

Solutions:
- Restart the development server completely
- Clear your browser cache and service worker registrations
- In Chrome, go to Application → Service Workers and click "Unregister" for any existing workers
- Make sure `devOptions.enabled` is set to `true` and `devOptions.type` is set to `'classic'` in the Vite config
- Add a development specific service worker (`dev-sw.js`) with minimal functionality
- Use incognito/private window for testing service worker functionality

### Development Mode Issues

#### Service Worker Registration Error (HTTP 500)

If you encounter this error during development:

```
Service worker registration error: TypeError: Failed to register a ServiceWorker for scope ('http://localhost:3000/') with script ('http://localhost:3000/dev-sw.js?dev-sw'): A bad HTTP response code (500) was received when fetching the script.
```

This is usually caused by:
1. The development service worker script not being properly loaded
2. A misconfiguration in the Vite PWA plugin setup
3. Conflicts with previous service worker registrations

Solutions:
- Restart the development server completely
- Clear your browser cache and service worker registrations
- In Chrome, go to Application → Service Workers and click "Unregister" for any existing workers
- Make sure `devOptions.enabled` is set to `true` and `devOptions.type` is set to `'classic'` in the Vite config

## Development

For developers working on PWA features:
- Review `vite.config.ts` for PWA configuration
- Service Worker code is generated by vite-plugin-pwa
- IndexedDB operations are in `src/lib/db.ts`
- Offline utilities are in `src/lib/pwa-utils.ts`
- Use the `useNetworkStatus` and `useAPI` hooks for offline-aware components
